---
// Redirigir a login si no está autenticado, o a dashboard si está autenticado
import { API_URL } from '../config/api';
---

<script define:vars={{ apiUrl: API_URL }}>
  window.API_URL = apiUrl;
</script>

<script>
  async function checkAuthAndRedirect() {
    try {
      const response = await fetch(`${window.API_URL}/users/me`, {
        credentials: 'include',
      });

      if (response.ok) {
        window.location.href = '/dashboard';
      } else {
        window.location.href = '/login';
      }
    } catch (error) {
      window.location.href = '/login';
    }
  }

  checkAuthAndRedirect();
</script>
